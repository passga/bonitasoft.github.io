<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Installation guide :: Bonita Documentation</title>
    <meta name="generator" content="Antora 2.3.4">
    <link rel="stylesheet" href="../_/stylesheets/site.css">
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.css"
    />
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <div class="navbar-item">
        <a class="bonita-logo" href="https://bonitasoft.github.io"></a>
      </div>

    </div>

    <div class="search-content">
      <fieldset>
        <input type="text" id="search-bar" placeholder="Search..." />
        <div class="icons-container">
          <div id="search-icon"></div>
        </div>
      </fieldset>
    </div>

    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-item is-hoverable">
        <a href="https://community.bonitasoft.com/" class="navbar-link">Community</a>
      </div>
      <div class="navbar-item is-hoverable">
        <a class="navbar-link" href="/bici/">Bonita ICI</a>
      </div>
    </div>

    <div class="navbar-item search-item hide-for-print">
      <input type="text" placeholder="Search Docs" class="search-bar query ds-input" id="search-query">
      <i class="search-icon" aria-hidden="true"></i>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="bici" data-version="master">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="./">Bonita ICI</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="release_notes">Release Notes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="architecture">Architecture</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="process_mining">Process mining</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="prerequisites">Pre-requisites</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="getting_started">Getting started</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="installation_guide">Installation guide</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="configure">Configuration Living Application</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="monitoring">Operations Management Living Application</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="rest_extensions">REST API extensions</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="send_data">Send us (anonymous) data!</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Bonita ICI</span>
    <span class="version">labs</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <span class="title">Bonita ICI</span>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="./">labs</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="./" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="./">Bonita ICI</a></li>
    <li><a href="installation_guide">Installation guide</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/bonitasoft/bonita-ici-doc/edit/master/modules/ROOT/pages/installation_guide.adoc">Edit this Page</a></div>
  </div>
  <div class="content">
<article class="doc">
<h1 class="page">Installation guide</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This installation guide covers ways to install BICI with the provided installer, as well as detailed available parameters
values.
The installation process allows to deploy BICI resources on Bonita and relies on Docker to deploy the BICI Add-on.</p>
</div>
<div class="paragraph">
<p>Please also have a look on the <a href="architecture" class="page">BICI architecture</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_bici_deliverable_content"><a class="anchor" href="#_bici_deliverable_content"></a>BICI deliverable content</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The deliverable is composed of the BICI application, two BICI Living Applications, and the BICI installer.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bonita-ici-&lt;VERSION&gt;.zip
    |---- bici-application-&lt;VERSION&gt;.zip          // BICI application
    |---- la-configuration-&lt;VERSION&gt;.zip          // Living Application for BICI Configuration
    |---- la-operations-management-&lt;VERSION&gt;.zip  // Living Application for BICI Operations Management
    |---- la.properties                           // configuration file used to deploy BICI Living Applications
    |---- installation-guide.md                   // this documentation
    |---- configuration.properties                // sample configuration file
    |---- bin/bonita-ici                          // installer startup script
    |---- bin/bonita-ici.bat                      // installer startup script (Windows)
    |---- jdbc_drivers/                           // folder where to put the jdbc driver to connect to the Bonita Database</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_general_prerequisites"><a class="anchor" href="#_general_prerequisites"></a>General Prerequisites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For a detailed list of supported environment and tools, see the <a href="prerequisites" class="page">prerequisites</a>.</p>
</div>
<div class="sect2">
<h3 id="_bonita"><a class="anchor" href="#_bonita"></a>Bonita</h3>
<div class="paragraph">
<p>You need an up and running Bonita instance, the BICI Application will connect directly to the Bonita Database.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bici_storage"><a class="anchor" href="#_bici_storage"></a>BICI Storage</h3>
<div class="paragraph">
<p>BICI Storage, which relies on Elasticsearch, even in a Docker container, requires a specific configuration of virtual memory
on the machine that hosts it. For more information, see <a href="https://www.elastic.co/guide/en/elasticsearch/reference/current/vm-max-map-count.html">Elasticsearch documentation</a></p>
</div>
<div class="paragraph">
<p>On a Linux host</p>
</div>
<div class="listingblock">
<div class="content">
<pre># configure runtime environnement
sudo sysctl -w vm.max_map_count=262144</pre>
</div>
</div>
<div class="paragraph">
<p>or edit file <code>/etc/sysctl.conf</code> file</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_installer"><a class="anchor" href="#_using_the_installer"></a>Using the installer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Extract the BICI deliverable on the host machine.</p>
</div>
<div class="paragraph">
<p>In the following, we will use <code>$BICI_INSTALLER_HOME</code> when noticing the directory where the installer has been extracted
on the host machine.</p>
</div>
<div class="sect2">
<h3 id="_docker"><a class="anchor" href="#_docker"></a>Docker</h3>
<div class="paragraph">
<p>The installer relies on Docker to deploy the BICI Add-on and is intended to be run on the Docker host directly</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Ensure you have Docker installed, using command <code>docker version</code></p>
</li>
<li>
<p>Docker requires an active Internet connection to pull the Elasticsearch Docker image and to build the BICI Application image</p>
</li>
</ul>
</div>
<div class="sect3">
<h4 id="_windows_os"><a class="anchor" href="#_windows_os"></a>Windows OS</h4>
<div class="paragraph">
<p>Due to a current limitation of the installer, you must set the <code>DOCKER_HOST</code> environment variable to let the installer
access to the Docker daemon</p>
</div>
<div class="paragraph">
<p>For instance</p>
</div>
<div class="listingblock">
<div class="content">
<pre>set DOCKER_HOST=tcp://localhost:2375</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bonita_database_access"><a class="anchor" href="#_bonita_database_access"></a>Bonita Database access</h3>
<div class="paragraph">
<p>Jdbc drivers for PostgreSQL, MySQL and MS SqlServer are already provided with the installer.</p>
</div>
<div class="paragraph">
<p>For Oracle only: copy the jdbc driver in <code>$BICI_INSTALLER_HOME/jdbc_drivers</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_full_installation_using_the_installer"><a class="anchor" href="#_full_installation_using_the_installer"></a>Full installation using the installer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This mode is designed to get a fully functional BICI Add-on including BICI Application, BICI Storage and BICI Living
Applications for configuration and operations management.</p>
</div>
<div class="sect2">
<h3 id="_full_installation_overview"><a class="anchor" href="#_full_installation_overview"></a>Full installation overview</h3>
<div class="imageblock">
<div class="content">
<img src="_images/images/bici_installation_installer_full.svg" alt="Full installation using the installer">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_installation"><a class="anchor" href="#_installation"></a>Installation</h3>
<div class="paragraph">
<p>Run the installer using <code>bonita-ici</code> (<code>bonita-ici.bat</code> on Windows platform) script that is located inside the <code>bin</code> folder</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
use <code>./bonita-ici --help</code> to display all options
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>By default, this installer performs the following operations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>stopApp</code>: stop and remove any existing BICI Application running (Docker container)</p>
</li>
<li>
<p><code>stopStorage</code>: stop and remove any BICI Storage (elasticsearch) Docker container</p>
</li>
<li>
<p><code>startStorage</code>: start an Elasticsearch Docker container</p>
</li>
<li>
<p><code>startApp</code>: configure and deploy the BICI Application as a Docker container</p>
</li>
<li>
<p><code>deploy</code>: deploy the BICI Living Applications configured to run on top of this installation.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_bici_installer_configuration"><a class="anchor" href="#_bici_installer_configuration"></a>BICI Installer Configuration</h3>

</div>
<div class="sect2">
<h3 id="_pass_parameters_using_configuration_file"><a class="anchor" href="#_pass_parameters_using_configuration_file"></a>Pass parameters using configuration file</h3>
<div class="paragraph">
<p>Parameters can be passed using a configuration file.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>./bonita-ici --file configuration.properties</pre>
</div>
</div>
<div class="paragraph">
<p>The sample configuration file named <code>configuration.properties</code> contains all properties that can be configured and configuration tips.</p>
</div>
</div>
<div class="sect2">
<h3 id="_bici_living_applications_deployment"><a class="anchor" href="#_bici_living_applications_deployment"></a>BICI Living Applications deployment</h3>
<div class="paragraph">
<p>You must update the <code>la.properties</code> configuration file to ensure the BICI Living Applications are able to communicate with the BICI Application.</p>
</div>
</div>
<div class="sect2">
<h3 id="_https_configuration"><a class="anchor" href="#_https_configuration"></a>Https configuration</h3>
<div class="paragraph">
<p><code>https</code> is activated by default on the BICI Application.</p>
</div>
<div class="paragraph">
<p>There are two ways to configure it.</p>
</div>
<div class="sect3">
<h4 id="_self_signed_certificate"><a class="anchor" href="#_self_signed_certificate"></a>Self-signed certificate</h4>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This is not recommended for a Production use of BICI. It is recommended to get your own certificate.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If you don&#8217;t already have a valid certificate for you platform or does not know what it is, choose this option.
A certificate will be generated for you based on configuration settings provided to the installer.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
When using this kind of certificate, the Bonita JVM must be restarted each time the BICI Application and Living Applications
are reinstalled.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_provide_your_own_certificate"><a class="anchor" href="#_provide_your_own_certificate"></a>Provide your own certificate</h4>
<div class="paragraph">
<p>If you already have a certificate and the associated private key of your domain, it can be given to the installer to be used in the backend to enable the https.</p>
</div>
<div class="paragraph">
<p>This certificate and the private key must be passed to the installer in a format compatible with the Java KeyStore.</p>
</div>
<div class="paragraph">
<p>Common supported formats are JKS and PKCS12.</p>
</div>
<div class="sect4">
<h5 id="_example_using_letsencrypts_certbot"><a class="anchor" href="#_example_using_letsencrypts_certbot"></a>Example using LetsEncrypt&#8217;s certbot:</h5>
<div class="paragraph">
<p>Generate a certificate for your local machine using the certbot of Lets encrypt using the following command line.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>certbot certonly</pre>
</div>
</div>
<div class="paragraph">
<p>(For more information, go to <a href="https://letsencrypt.org/getting-started/">Let&#8217;s Encrypt documentation</a>)</p>
</div>
<div class="paragraph">
<p>Convert the certificate given by LetsEncrypt into a PKCS12 format.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>openssl pkcs12 -export -in /etc/letsencrypt/live/{domain}/fullchain.pem -inkey /etc/letsencrypt/live/{domain}/privkey.pem -out mykey.p12 -name myAlias</pre>
</div>
</div>
<div class="paragraph">
<p>Then when using the installer provide this generated file as a keystore, the same password for the keystore and the key, and the same alias.</p>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_update_the_certificate"><a class="anchor" href="#_update_the_certificate"></a>Update the certificate</h4>
<div class="paragraph">
<p>When the certificate expires, it can replaced by a new certificate generated by the installer or one that you provide.</p>
</div>
<div class="paragraph">
<p>Replace it by reinstalling the BICI Application and BICI Living Applications:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>stop the BICI Application using <code>bonita-ici stopApp</code></p>
</li>
<li>
<p>start the BICI Application and redeploy BICI Living Applications using either the new certificate or newly generated one
using <code>bonita-ici startApp deploy</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the certificate is autogenerated, the Bonita JVM needs to be restarted.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_stop_the_bici_application"><a class="anchor" href="#_stop_the_bici_application"></a>Stop the BICI Application</h3>
<div class="paragraph">
<p>It can be stopped using <code>bonita-ici stopStorage stopApp</code></p>
</div>
<div class="paragraph">
<p>In that case, the BICI Application and Storage containers are dropped</p>
</div>
</div>
<div class="sect2">
<h3 id="_advanced_polling_profile_mode"><a class="anchor" href="#_advanced_polling_profile_mode"></a>Advanced polling profile mode</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
This mode is only available when Bonita is using: Oracle or PostgreSQL Database
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This mode requires that the database user is allowed to create materialized views.
To grant this in:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Oracle</p>
<div class="ulist">
<ul>
<li>
<p><code>GRANT CREATE MATERIALIZED VIEW TO &lt;USER&gt;</code> using a SYS connection prior to start the application.</p>
</li>
</ul>
</div>
</li>
<li>
<p>PostgreSQL</p>
<div class="ulist">
<ul>
<li>
<p><code>GRANT CONNECT ON DATABASE &lt;DB_NAME&gt;&gt; TO &lt;USER&gt;</code> is sufficient to create a view</p>
</li>
<li>
<p><code>GRANT SELECT ON TABLE &lt;SCHEMA&gt;.arch_flownode_instance TO &lt;USER&gt;</code> is needed to REFRESH MATERIALIZED VIEW</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>To activate this mode when using the configuration file, set</p>
</div>
<div class="listingblock">
<div class="content">
<pre>polling.profile=advanced</pre>
</div>
</div>
<div class="paragraph">
<p>When using the interactive installer mode, answer <code>advanced</code> when the <code>Enter Polling profile</code> question is asked</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_installation_with_a_manually_installed_elasticsearch"><a class="anchor" href="#_installation_with_a_manually_installed_elasticsearch"></a>Installation with a manually installed Elasticsearch</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_overview"><a class="anchor" href="#_overview"></a>Overview</h3>
<div class="paragraph">
<p>In that case, you request the BICI installer to perform the same operations as in the full installation but it will not
try to start the BICI Storage Docker container and it will use the instance specified by configuration.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="_images/images/bici_installation_installer_no_elasticsearch.svg" alt="Full installation using the installer">
</div>
</div>
</div>
<div class="sect2">
<h3 id="_bici_installer_configuration_2"><a class="anchor" href="#_bici_installer_configuration_2"></a>BICI Installer Configuration</h3>
<div class="paragraph">
<p>If you want to use a your own manually installed Elasticsearch, change the following properties in the <code>configuration.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>elasticsearch.port=&lt;port of the elasticsearch&gt;
elasticsearch.host=&lt;host of the elasticsearch&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>If you use the interactive installer mode, provide the host and port of the running Elasticsearch instance when requested
by the installer.</p>
</div>
</div>
<div class="sect2">
<h3 id="_installation_2"><a class="anchor" href="#_installation_2"></a>Installation</h3>
<div class="paragraph">
<p>Then run the installer like this (pass the configuration file option if needed):</p>
</div>
<div class="listingblock">
<div class="content">
<pre>bonita-ici startApp deploy</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_troubleshooting"><a class="anchor" href="#_troubleshooting"></a>Troubleshooting</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_polling_errors"><a class="anchor" href="#_polling_errors"></a>Polling errors</h3>
<div class="paragraph">
<p>When a polling execution fails, it can be seen in error in BICI Configuration Living Application.</p>
</div>
<div class="paragraph">
<p>More information is available in the logs of the BICI Application Docker container.
To find the logs you must get the ID of the BICI Application docker container:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker container ls</pre>
</div>
</div>
<div class="paragraph">
<p>Next, typing the following command will display the logs:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>docker logs CONTAINER_ID        \\i.e. docker logs 2e169fd6c305</pre>
</div>
</div>
</div>
</div>
</div>
</article>
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
  </div>
</main>
</div>
<footer class="footer">
  <p>This page was built using the Antora default UI.</p>
  <p>The source code for this UI is licensed under the terms of the MPL-2.0 license.</p>
</footer>
<script src="../_/js/site.js"></script>
<script async src="../_/js/vendor/highlight.js"></script>

<script src="https://cdn.jsdelivr.net/npm/docsearch.js@2.6.3/dist/cdn/docsearch.min.js"></script>
<script>
  docsearch({
    // Your apiKey and indexName will be given to you once
    // we create your config
    apiKey: '8b16fe941025bb59db192dce337bc486',
    indexName: 'test_BONITA',
    appId: 'LMVLEZKT54', // Should be only included if you are running DocSearch on your own.
    // Replace inputSelector with a CSS selector
    // matching your search input
    inputSelector: '#search-query',
    // Set debug to true to inspect the dropdown
    debug: false,
    algoliaOptions: {
      'facetFilters': ["tags:master", "tags:bici"]
    },
  });
</script>
  </body>
</html>
